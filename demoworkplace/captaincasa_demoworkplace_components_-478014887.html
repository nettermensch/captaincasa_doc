<html>
<head>
<style>
.java {font-family: monospace;background-color: #F0F0F0;}
.xml {font-family: monospace;background-color: #F0F0F0;}
</style>
</head>
<body>
<p>The context of this demo is the creation of a dialog using the CaptainCasa framework for the following purpose: <ul><li>Components</li><li>Straight Controls</li><li>File Up/Download</li><li>Triggered by User</li></ul></p>
<p>The FILEUPLOAD and FILEUPLOADLINK components start an upload of a client side file. They are the most simple to use implementation because the file content is passed as server side event parameter.<br><br>For downloading file there are components as well: FILEDOWNLOADLINK and FILEDOWNLOADBUTTON. You pass a URL and a file name (without directory) - a popup will show up letting the user select where to download the URL content to.<br><br>Please note: FILEUPLOAD and FILEUPLOADLINK directly embed the file content into the request that is just normally sent to the server side. This means: in case of big files, the request will take some duration as consequence. For uploading bigger files there is an asynchronous upload as well, which also allows the user to observe the upload status.</p>
<p>This is the XML layout definition:</p>
<p class="xml">&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;?&gt;<br>&lt;t:layoutdefinition&nbsp;xmlns:t=&#34;http://www.CaptainCasa.com/controllibrary/t&#34;&nbsp;xmlns:tpbc=&#34;http://www.CaptainCasa.com/controllibrary/tpbc&#34;&nbsp;&gt;<br>&lt;t:rowdemobodypane&nbsp;id=&#34;g_1&#34;&nbsp;objectbinding=&#34;#{d.DemoFile}&#34;&nbsp;rowdistance=&#34;#{ccstylevalue[&#39;@defaultrowdistance@&#39;]}&#34;&nbsp;&gt;<br>&lt;t:row&nbsp;id=&#34;g_2&#34;&nbsp;&gt;<br>&lt;t:label&nbsp;id=&#34;g_3&#34;&nbsp;text=&#34;File&nbsp;download&nbsp;link&#34;&nbsp;width=&#34;150&#34;&nbsp;/&gt;<br>&lt;t:filedownloadlink&nbsp;id=&#34;g_4&#34;&nbsp;fileextensions=&#34;png&#34;&nbsp;text=&#34;Download&nbsp;File...&#34;&nbsp;url=&#34;/images/icons/car.png&#34;&nbsp;filename=&#34;car.png&#34;&nbsp;/&gt;<br>&lt;/t:row&gt;<br>&lt;t:row&nbsp;id=&#34;g_5&#34;&nbsp;&gt;<br>&lt;t:label&nbsp;id=&#34;g_6&#34;&nbsp;text=&#34;File&nbsp;download&nbsp;button&#34;&nbsp;width=&#34;150&#34;&nbsp;/&gt;<br>&lt;t:filedownloadbutton&nbsp;id=&#34;g_7&#34;&nbsp;contentareafilled=&#34;false&#34;&nbsp;image=&#34;/images/icons/car.png&#34;&nbsp;text=&#34;Download&nbsp;File...&#34;&nbsp;url=&#34;/images/icons/car.png&#34;&nbsp;filename=&#34;car.png&#34;&nbsp;iconrollover=&#34;true&#34;&nbsp;/&gt;<br>&lt;/t:row&gt;<br>&lt;t:rowdistance&nbsp;id=&#34;g_8&#34;&nbsp;height=&#34;20&#34;&nbsp;/&gt;<br>&lt;t:rowline&nbsp;id=&#34;g_9&#34;&nbsp;/&gt;<br>&lt;t:rowdistance&nbsp;id=&#34;g_10&#34;&nbsp;height=&#34;20&#34;&nbsp;/&gt;<br>&lt;t:row&nbsp;id=&#34;g_11&#34;&nbsp;&gt;<br>&lt;t:label&nbsp;id=&#34;g_12&#34;&nbsp;text=&#34;File&nbsp;upload&nbsp;link&#34;&nbsp;width=&#34;150&#34;&nbsp;/&gt;<br>&lt;t:fileuploadlink&nbsp;id=&#34;g_17&#34;&nbsp;actionListener=&#34;#{d.DemoFile.onFileNameAction}&#34;&nbsp;maxfilesize=&#34;100000&#34;&nbsp;text=&#34;Upload&nbsp;File...&#34;&nbsp;tooltip=&#34;Here&nbsp;you&nbsp;can&nbsp;upload&nbsp;files.&#34;&nbsp;/&gt;<br>&lt;/t:row&gt;<br>&lt;t:row&nbsp;id=&#34;g_18&#34;&nbsp;&gt;<br>&lt;t:label&nbsp;id=&#34;g_29&#34;&nbsp;text=&#34;File&nbsp;upload&nbsp;button&#34;&nbsp;width=&#34;150&#34;&nbsp;/&gt;<br>&lt;t:fileuploadbutton&nbsp;id=&#34;g_20&#34;&nbsp;actionListener=&#34;#{d.DemoFile.onFileNameAction}&#34;&nbsp;fileextensions=&#34;png;gif;jpg;bmp&#34;&nbsp;maxfilesize=&#34;50000000000&#34;&nbsp;text=&#34;Upload&nbsp;File...&#34;&nbsp;iconrollover=&#34;true&#34;&nbsp;/&gt;<br>&lt;/t:row&gt;<br>&lt;t:rowdistance&nbsp;id=&#34;g_21&#34;&nbsp;height=&#34;10&#34;&nbsp;/&gt;<br>&lt;t:row&nbsp;id=&#34;g_22&#34;&nbsp;&gt;<br>&lt;t:coldistance&nbsp;id=&#34;g_23&#34;&nbsp;width=&#34;150&#34;&nbsp;/&gt;<br>&lt;t:textarea&nbsp;id=&#34;g_24&#34;&nbsp;background=&#34;#F0F0F0&#34;&nbsp;height=&#34;100%&#34;&nbsp;text=&#34;#{d.DemoFile.fileHexContent}&#34;&nbsp;width=&#34;100%&#34;&nbsp;/&gt;<br>&lt;/t:row&gt;<br>&lt;/t:rowdemobodypane&gt;<br>&lt;t:pageaddons&nbsp;id=&#34;g_pa&#34;/&gt;<br>&lt;/t:layoutdefinition&gt;</p>
<p>This is the Java code:</p>
<p class="java">package&nbsp;workplace;<br><br>import&nbsp;javax.faces.event.ActionEvent;<br><br>import&nbsp;org.eclnt.jsfserver.defaultscreens.Statusbar;<br>import&nbsp;org.eclnt.jsfserver.elements.BaseActionComponent;<br>import&nbsp;org.eclnt.jsfserver.elements.BaseActionEvent;<br>import&nbsp;org.eclnt.jsfserver.elements.events.BaseActionEventUpload;<br>import&nbsp;org.eclnt.util.log.CLog;<br>import&nbsp;org.eclnt.util.valuemgmt.ValueManager;<br>import&nbsp;org.eclnt.workplace.IWorkpageDispatcher;<br><br>public&nbsp;class&nbsp;DemoFile&nbsp;extends&nbsp;WorkpageDispatchedPageBean<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;m_fileName;<br>&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;m_fileHexContent;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;DemoFile(IWorkpageDispatcher&nbsp;dispatcher)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(dispatcher);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setFileName(String&nbsp;value)&nbsp;{&nbsp;m_fileName&nbsp;=&nbsp;value;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getFileName()&nbsp;{&nbsp;return&nbsp;m_fileName;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setFileHexContent(String&nbsp;value)&nbsp;{&nbsp;m_fileHexContent&nbsp;=&nbsp;value;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getFileHexContent()&nbsp;{&nbsp;return&nbsp;m_fileHexContent;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;onFileNameAction(ActionEvent&nbsp;ae)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(ae&nbsp;instanceof&nbsp;BaseActionEventUpload)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{&nbsp;Thread.currentThread().sleep(5000);&nbsp;}&nbsp;catch&nbsp;(Throwable&nbsp;t)&nbsp;{}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseActionEventUpload&nbsp;bae&nbsp;=&nbsp;(BaseActionEventUpload)ae;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_fileHexContent&nbsp;=&nbsp;bae.getHexByteString();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Statusbar.outputMessage(&#34;File&nbsp;&#34;&nbsp;+&nbsp;bae.getClientFileName()&nbsp;+&nbsp;&#34;&nbsp;(length=&#34;+m_fileHexContent.length()/2+&#34;)&nbsp;was&nbsp;uploaded.&#34;);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></p>
</body>
</html>
