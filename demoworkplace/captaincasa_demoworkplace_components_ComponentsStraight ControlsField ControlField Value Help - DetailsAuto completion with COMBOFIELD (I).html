<p>The context of this demo is the creation of a dialog using the CaptainCasa framework for the following purpose: <ul><li>Components</li><li>Straight Controls</li><li>Field Control</li><li>Field Value Help - Details</li><li>Auto completion with COMBOFIELD (I)</li></ul></p>
<p>This demo shows how to flexible use the COMBOFIELD in order to provide some auto complete function.<br><br>The value help for the COMBOFIELD shows up when either explicitly requesting it (pressing the icon, F4 or ctrl-space) or when keying in some characters and waiting a certain duration.<br><br>The following issues are the one, which are important:<br><br>1. COMBOFIELD-FLUSH and FLUSHTIMER is set in order to tell the server that values have changed<br>2. COMBOFIELD-KEEPFOCUS is switched to true, so that the focus is not moved into the value help dialog, but so that the focus stays with the COMBOFIELD<br><br>On server side the value help dialog is a just normal PageBean modeless popup.<br><br>Here it makes sense to...<br>1. use the lightway style for modeless popups: undecorated, with &#34;clickoncloseoutside&#34;<br>2. manage the popup in a way so that you check if the popup is already opened etc. - not to open the popup twice<br>3. tell the popup that it should not focus the calling component when being closed<br><br>Please pay attention: when using this demo with JavaFX 2.2 then there will be some problems within the focus management... These problems are fixed with JavaFX 3.  </p>
<p>This is the XML layout definition:</p>
<p class="xml">&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;?&gt;<br>&lt;t:layoutdefinition&nbsp;xmlns:t=&#34;http://www.CaptainCasa.com/controllibrary/t&#34;&nbsp;xmlns:tpbc=&#34;http://www.CaptainCasa.com/controllibrary/tpbc&#34;&nbsp;&gt;<br>&lt;t:rowdemobodypane&nbsp;id=&#34;g_1&#34;&nbsp;objectbinding=&#34;#{d.DemoCombofieldAutoComplete}&#34;&nbsp;&gt;<br>&lt;t:row&nbsp;id=&#34;g_2&#34;&nbsp;&gt;<br>&lt;t:textpane&nbsp;id=&#34;g_3&#34;&nbsp;text=&#34;Key&nbsp;in&nbsp;some&nbsp;text&nbsp;in&nbsp;the&nbsp;Person-field.&nbsp;Either&nbsp;wait&nbsp;a&nbsp;short&nbsp;duration&nbsp;or&nbsp;press&nbsp;ctrl-space&nbsp;or&nbsp;F4&nbsp;in&nbsp;order&nbsp;to&nbsp;open&nbsp;the&nbsp;auto&nbsp;completion&nbsp;value&nbsp;help.&#34;&nbsp;width=&#34;100%&#34;&nbsp;/&gt;<br>&lt;/t:row&gt;<br>&lt;t:rowdistance&nbsp;id=&#34;g_4&#34;&nbsp;height=&#34;20&#34;&nbsp;/&gt;<br>&lt;t:row&nbsp;id=&#34;g_5&#34;&nbsp;&gt;<br>&lt;t:combofield&nbsp;id=&#34;g_6&#34;&nbsp;actionListener=&#34;#{d.DemoCombofieldAutoComplete.onPersonAction}&#34;&nbsp;flush=&#34;true&#34;&nbsp;flushtimer=&#34;1000&#34;&nbsp;keepfocus=&#34;true&#34;&nbsp;labeltext=&#34;Person&#34;&nbsp;text=&#34;#{d.DemoCombofieldAutoComplete.person}&#34;&nbsp;width=&#34;200&#34;&nbsp;/&gt;<br>&lt;/t:row&gt;<br>&lt;/t:rowdemobodypane&gt;<br>&lt;t:pageaddons&nbsp;id=&#34;g_pa&#34;/&gt;<br>&lt;/t:layoutdefinition&gt;</p>
<p>This is the Java code:</p>
<p class="java">package&nbsp;workplace;<br><br>import&nbsp;java.io.Serializable;<br>import&nbsp;org.eclnt.editor.annotations.CCGenClass;<br>import&nbsp;org.eclnt.jsfserver.defaultscreens.ModelessPopup;<br>import&nbsp;org.eclnt.jsfserver.elements.events.BaseActionEventFlush;<br>import&nbsp;org.eclnt.jsfserver.elements.events.BaseActionEventValueHelp;<br>import&nbsp;org.eclnt.jsfserver.pagebean.PageBean;<br>import&nbsp;org.eclnt.jsfserver.util.HttpSessionAccess;<br>import&nbsp;org.eclnt.workplace.IWorkpageDispatcher;<br><br>import&nbsp;javax.faces.event.ActionEvent;<br><br>@CCGenClass&nbsp;(expressionBase=&#34;#{d.DemoCombofieldAutoComplete}&#34;)<br><br>public&nbsp;class&nbsp;DemoCombofieldAutoComplete<br>&nbsp;&nbsp;&nbsp;&nbsp;extends&nbsp;PageBean<br>&nbsp;&nbsp;&nbsp;&nbsp;implements&nbsp;Serializable<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;inner&nbsp;classes<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;Listener&nbsp;to&nbsp;the&nbsp;user&nbsp;of&nbsp;the&nbsp;page&nbsp;bean.&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;interface&nbsp;IListener<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;members<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;IListener&nbsp;m_listener;<br>&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;m_person;<br>&nbsp;&nbsp;&nbsp;&nbsp;DemoCombofieldAutoCompleteValueHelp&nbsp;m_personValueHelp&nbsp;=&nbsp;null;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;constructors&nbsp;&amp;&nbsp;initialization<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;DemoCombofieldAutoComplete(IWorkpageDispatcher&nbsp;dispatcher)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(dispatcher);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;public&nbsp;usage<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br><br>&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;Initialization&nbsp;of&nbsp;the&nbsp;bean.&nbsp;Add&nbsp;any&nbsp;parameter&nbsp;that&nbsp;is&nbsp;required&nbsp;within&nbsp;your&nbsp;scenario.&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;prepare(IListener&nbsp;listener)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_listener&nbsp;=&nbsp;listener;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getPerson()&nbsp;{&nbsp;return&nbsp;m_person;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setPerson(String&nbsp;value)&nbsp;{&nbsp;this.m_person&nbsp;=&nbsp;value;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;onPersonAction(ActionEvent&nbsp;event)&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;the&nbsp;popup&nbsp;is&nbsp;triggered&nbsp;either&nbsp;if&nbsp;explicitly&nbsp;requested...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(event&nbsp;instanceof&nbsp;BaseActionEventValueHelp)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showPersonValueHelp();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;...or&nbsp;if&nbsp;a&nbsp;flush&nbsp;event&nbsp;was&nbsp;received&nbsp;that&nbsp;was&nbsp;caused&nbsp;by&nbsp;a&nbsp;flush&nbsp;timer<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;(and&nbsp;NOT&nbsp;by&nbsp;the&nbsp;user&nbsp;moving&nbsp;to&nbsp;the&nbsp;next&nbsp;field)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(event&nbsp;instanceof&nbsp;BaseActionEventFlush)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseActionEventFlush&nbsp;e&nbsp;=&nbsp;(BaseActionEventFlush)event;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(e.getFlushWasTriggeredByTimer())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showPersonValueHelp();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;private&nbsp;usage<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;showPersonValueHelp()<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;already&nbsp;shown?&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(m_personValueHelp&nbsp;==&nbsp;null)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_personValueHelp&nbsp;=&nbsp;new&nbsp;DemoCombofieldAutoCompleteValueHelp();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ModelessPopup&nbsp;mp&nbsp;=&nbsp;openModelessPopup(m_personValueHelp,&#34;&#34;,0,0,new&nbsp;ModelessPopup.IModelessPopupListener()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;reactOnPopupClosedByUser()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closePersonValueHelp();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mp.setUndecorated(true);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;mp.setAvoidfocussingofopener(true);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mp.setCloseonclickoutside(true);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mp.setStyleseq(&#34;riscdialog_popup_transparent&#34;);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_personValueHelp.prepare(new&nbsp;DemoCombofieldAutoCompleteValueHelp.IListener()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;reactOnPersonSelected(String&nbsp;person)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_person&nbsp;=&nbsp;person;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closePersonValueHelp();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},m_person);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;closePersonValueHelp()<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(m_personValueHelp&nbsp;==&nbsp;null)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closePopup(m_personValueHelp);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_personValueHelp&nbsp;=&nbsp;null;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></p>
