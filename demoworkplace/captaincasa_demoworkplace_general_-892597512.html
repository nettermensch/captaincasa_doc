<html>
<head>
<style>
.java {font-family: monospace;background-color: #F0F0F0;}
.xml {font-family: monospace;background-color: #F0F0F0;}
</style>
</head>
<body>
<p>The context of this demo is the creation of a dialog using the CaptainCasa framework for the following purpose: <ul><li>General</li><li>General Issues</li><li>Local Client Configuration</li></ul></p>
<p>On client side there is one file that holds certain client-specific configuration:<br><br>(.) the id of the client<br>(.) the &#34;local directory&#34; of the client (the one used for automated upload/download)<br>(.) an indicator if automated file functions are supported<br><br>The file is kept on client side within the temporary directory that is assigned by the operating system environment.<br><br>You can up/download this configuration file in just normal way. The client file&#39;s name is ${temp}/eclnt/eclntconfig.xml.</p>
<p>This is the XML layout definition:</p>
<p class="xml">&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;?&gt;<br>&lt;t:layoutdefinition&nbsp;xmlns:t=&#34;http://www.CaptainCasa.com/controllibrary/t&#34;&nbsp;xmlns:tpbc=&#34;http://www.CaptainCasa.com/controllibrary/tpbc&#34;&nbsp;&gt;<br>&lt;t:beanprocessing&nbsp;id=&#34;g_1&#34;&nbsp;&gt;<br>&lt;t:filedownload&nbsp;id=&#34;g_2&#34;&nbsp;filename=&#34;{temp}/eclnt/eclntconfig.xml&#34;&nbsp;trigger=&#34;#{d.DemoLocalClientConfig.downloadTrigger}&#34;&nbsp;url=&#34;#{d.DemoLocalClientConfig.downloadURL}&#34;&nbsp;/&gt;<br>&lt;/t:beanprocessing&gt;<br>&lt;t:rowdemobodypane&nbsp;id=&#34;g_3&#34;&nbsp;objectbinding=&#34;#{d.DemoLocalClientConfig}&#34;&nbsp;rowdistance=&#34;10&#34;&nbsp;&gt;<br>&lt;t:row&nbsp;id=&#34;g_4&#34;&nbsp;&gt;<br>&lt;t:coldistance&nbsp;id=&#34;g_5&#34;&nbsp;width=&#34;100&#34;&nbsp;/&gt;<br>&lt;t:fileuploadbutton&nbsp;id=&#34;g_6&#34;&nbsp;actionListener=&#34;#{d.DemoLocalClientConfig.onUpload}&#34;&nbsp;filename=&#34;{temp}/eclnt/eclntconfig.xml&#34;&nbsp;maxfilesize=&#34;100000&#34;&nbsp;text=&#34;Upload&nbsp;to&nbsp;Server&#34;&nbsp;width=&#34;150&#34;&nbsp;/&gt;<br>&lt;/t:row&gt;<br>&lt;t:row&nbsp;id=&#34;g_7&#34;&nbsp;&gt;<br>&lt;t:coldistance&nbsp;id=&#34;g_8&#34;&nbsp;width=&#34;100&#34;&nbsp;/&gt;<br>&lt;t:button&nbsp;id=&#34;g_9&#34;&nbsp;actionListener=&#34;#{d.DemoLocalClientConfig.onCreateTemplate}&#34;&nbsp;text=&#34;Create&nbsp;Template&#34;&nbsp;width=&#34;150&#34;&nbsp;/&gt;<br>&lt;/t:row&gt;<br>&lt;t:row&nbsp;id=&#34;g_10&#34;&nbsp;&gt;<br>&lt;t:label&nbsp;id=&#34;g_11&#34;&nbsp;text=&#34;Content&#34;&nbsp;width=&#34;100&#34;&nbsp;/&gt;<br>&lt;t:textarea&nbsp;id=&#34;g_12&#34;&nbsp;flush=&#34;true&#34;&nbsp;height=&#34;150&#34;&nbsp;text=&#34;#{d.DemoLocalClientConfig.content}&#34;&nbsp;width=&#34;100%&#34;&nbsp;/&gt;<br>&lt;/t:row&gt;<br>&lt;t:row&nbsp;id=&#34;g_13&#34;&nbsp;&gt;<br>&lt;t:coldistance&nbsp;id=&#34;g_14&#34;&nbsp;width=&#34;100&#34;&nbsp;/&gt;<br>&lt;t:button&nbsp;id=&#34;g_15&#34;&nbsp;actionListener=&#34;#{d.DemoLocalClientConfig.onDownload}&#34;&nbsp;text=&#34;Download&nbsp;to&nbsp;Client&#34;&nbsp;width=&#34;150&#34;&nbsp;/&gt;<br>&lt;t:coldistance&nbsp;id=&#34;g_16&#34;&nbsp;width=&#34;100%&#34;&nbsp;/&gt;<br>&lt;t:button&nbsp;id=&#34;g_17&#34;&nbsp;actionListener=&#34;#{d.DemoLocalClientConfig.onReloadClient}&#34;&nbsp;text=&#34;Reload&nbsp;Client&#34;&nbsp;width=&#34;100&#34;&nbsp;/&gt;<br>&lt;/t:row&gt;<br>&lt;/t:rowdemobodypane&gt;<br>&lt;t:pageaddons&nbsp;id=&#34;g_pa&#34;/&gt;<br>&lt;/t:layoutdefinition&gt;</p>
<p>This is the Java code:</p>
<p class="java">package&nbsp;workplace;<br><br>import&nbsp;java.io.Serializable;<br><br>import&nbsp;javax.faces.event.ActionEvent;<br><br>import&nbsp;org.eclnt.editor.annotations.CCGenClass;<br>import&nbsp;org.eclnt.jsfserver.bufferedcontent.BufferedContentMgr;<br>import&nbsp;org.eclnt.jsfserver.bufferedcontent.DefaultBufferedContent;<br>import&nbsp;org.eclnt.jsfserver.defaultscreens.Statusbar;<br>import&nbsp;org.eclnt.jsfserver.elements.events.BaseActionEventUpload;<br>import&nbsp;org.eclnt.jsfserver.elements.util.Trigger;<br>import&nbsp;org.eclnt.jsfserver.util.HttpSessionAccess;<br>import&nbsp;org.eclnt.util.log.CLog;<br>import&nbsp;org.eclnt.workplace.IWorkpageDispatcher;<br>import&nbsp;org.eclnt.workplace.IWorkpageLifecycleListener;<br>import&nbsp;org.eclnt.workplace.WorkpageDefaultLifecycleListener;<br><br>@CCGenClass&nbsp;(expressionBase=&#34;#{d.DemoLocalClientConfig}&#34;)<br><br>public&nbsp;class&nbsp;DemoLocalClientConfig<br>&nbsp;&nbsp;&nbsp;&nbsp;extends&nbsp;PageBean<br>&nbsp;&nbsp;&nbsp;&nbsp;implements&nbsp;Serializable<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;MyBufferedContent&nbsp;extends&nbsp;DefaultBufferedContent<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;byte[]&nbsp;getContent()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(m_content&nbsp;==&nbsp;null)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;Error(&#34;No&nbsp;content&#34;);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;m_content.getBytes(&#34;UTF-8&#34;);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch&nbsp;(Throwable&nbsp;t)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLog.L.log(CLog.LL_ERR,&#34;Problem&nbsp;when&nbsp;passing&nbsp;back&nbsp;content&#34;);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;Error(t);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getContentType()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;m_content;<br>&nbsp;&nbsp;&nbsp;&nbsp;MyBufferedContent&nbsp;m_bufferedContent;<br>&nbsp;&nbsp;&nbsp;&nbsp;Trigger&nbsp;m_downloadTrigger&nbsp;=&nbsp;new&nbsp;Trigger();<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;DemoLocalClientConfig(IWorkpageDispatcher&nbsp;dispatcher)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(dispatcher);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_bufferedContent&nbsp;=&nbsp;new&nbsp;MyBufferedContent();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BufferedContentMgr.add(m_bufferedContent);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getWorkpage().addLifecycleListener(new&nbsp;WorkpageDefaultLifecycleListener()&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;reactOnDestroyed()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BufferedContentMgr.remove(m_bufferedContent);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_bufferedContent&nbsp;=&nbsp;null;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getContent()&nbsp;{&nbsp;return&nbsp;m_content;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setContent(String&nbsp;value)&nbsp;{&nbsp;m_content&nbsp;=&nbsp;value;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getDownloadURL()&nbsp;{&nbsp;return&nbsp;m_bufferedContent.getURL();&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Trigger&nbsp;getDownloadTrigger()&nbsp;{&nbsp;return&nbsp;m_downloadTrigger;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;onUpload(ActionEvent&nbsp;event)&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(event&nbsp;instanceof&nbsp;BaseActionEventUpload)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseActionEventUpload&nbsp;ue&nbsp;=&nbsp;(BaseActionEventUpload)event;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte[]&nbsp;bytes&nbsp;=&nbsp;ue.getHexBytes();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_content&nbsp;=&nbsp;new&nbsp;String(bytes,&#34;UTF-8&#34;);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch&nbsp;(Throwable&nbsp;t)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Statusbar.outputAlert(t.toString());<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;onReloadClient(ActionEvent&nbsp;event)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpSessionAccess.reloadClient();<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;onDownload(ActionEvent&nbsp;event)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(m_content&nbsp;==&nbsp;null&nbsp;||&nbsp;m_content.trim().length()&nbsp;==&nbsp;0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Statusbar.outputAlert(&#34;No&nbsp;content&nbsp;for&nbsp;download&nbsp;defined.&#34;);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_downloadTrigger.trigger();<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;onCreateTemplate(ActionEvent&nbsp;event)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_content&nbsp;=&nbsp;&#34;&lt;clientconfig&gt;&#92;n&#34;&nbsp;+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&lt;clientid&nbsp;value=&#39;CLIENTID&#39;/&gt;&#92;n&#34;&nbsp;+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&lt;localdirectory&nbsp;value=&#39;c:&#92;&#92;temp&#92;&#92;&#39;/&gt;&#92;n&#34;&nbsp;+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;&nbsp;&nbsp;&nbsp;&nbsp;&lt;suppressautofilefunctions&nbsp;value=&#39;false&#39;/&gt;&#92;n&#34;&nbsp;+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;&lt;/clientconfig&gt;&#92;n&#34;;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>}<br></p>
</body>
</html>
