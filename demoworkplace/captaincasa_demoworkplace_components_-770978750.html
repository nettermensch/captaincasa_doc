<html>
<head>
<style>
.java {font-family: monospace;background-color: #F0F0F0;}
.xml {font-family: monospace;background-color: #F0F0F0;}
</style>
</head>
<body>
<p>The context of this demo is the creation of a dialog using the CaptainCasa framework for the following purpose: <ul><li>Components</li><li>Animation &amp; Graphics &amp; Sound</li><li>Paint Area</li><li>Selection of items</li></ul></p>
<p>The PAINTAREA supports the selection of contained PAINTAREAITEM instances.<br><br>You may either select by mouse-range selection or by clicking individual items. When clicking you may use the ctrl-Key in order to do multiple selections.<br><br>When selecting multiple items then all the items are moved when moving one item.<br><br>The selected-status is reflected into a corresponding attribute PAINTAREAITEM-SELECTED. The attribute must be bound to some server side expression, so that the actual selection can be passed into the server processing.<br><br>As with the position and size of a PAINTAREAITEM, the selection information is not immediately passed to the server side by default - but waits for the next synchronization to the server (e.g. due to the user pressing a button). You may set PAINTAREAITEM-FLUSH to true in order to immediately send selections to the server side.</p>
<p>This is the XML layout definition:</p>
<p class="xml">&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;?&gt;<br>&lt;t:layoutdefinition&nbsp;xmlns:t=&#34;http://www.CaptainCasa.com/controllibrary/t&#34;&nbsp;xmlns:tpbc=&#34;http://www.CaptainCasa.com/controllibrary/tpbc&#34;&nbsp;&gt;<br>&lt;t:rowdemobodypane&nbsp;id=&#34;g_1&#34;&nbsp;objectbinding=&#34;#{d.DemoPaintAreaSelection}&#34;&nbsp;rowdistance=&#34;#{ccstylevalue[&amp;#39;@defaultrowdistance@&amp;#39;]}&#34;&nbsp;&gt;<br>&lt;t:row&nbsp;id=&#34;g_2&#34;&nbsp;&gt;<br>&lt;t:coldistance&nbsp;id=&#34;g_6&#34;&nbsp;width=&#34;100%&#34;&nbsp;/&gt;<br>&lt;t:label&nbsp;id=&#34;g_7&#34;&nbsp;text=&#34;Sacle&nbsp;(%)&#34;&nbsp;/&gt;<br>&lt;t:slider&nbsp;id=&#34;g_5&#34;&nbsp;flush=&#34;true&#34;&nbsp;flushtimer=&#34;300&#34;&nbsp;majortickspacing=&#34;25&#34;&nbsp;maxvalue=&#34;200&#34;&nbsp;minortickspacing=&#34;5&#34;&nbsp;minvalue=&#34;50&#34;&nbsp;value=&#34;#{d.DemoPaintAreaSelection.scalePercent}&#34;&nbsp;width=&#34;300&#34;&nbsp;/&gt;<br>&lt;/t:row&gt;<br>&lt;t:row&nbsp;id=&#34;g_10&#34;&nbsp;&gt;<br>&lt;t:scrollpane&nbsp;id=&#34;g_11&#34;&nbsp;border=&#34;#00000030&#34;&nbsp;height=&#34;100%&#34;&nbsp;width=&#34;100%&#34;&nbsp;&gt;<br>&lt;t:row&nbsp;id=&#34;g_12&#34;&nbsp;&gt;<br>&lt;t:scalepane&nbsp;id=&#34;g_8&#34;&nbsp;flush=&#34;true&#34;&nbsp;height=&#34;100%&#34;&nbsp;scale=&#34;#{d.DemoPaintAreaSelection.scale}&#34;&nbsp;width=&#34;100%&#34;&nbsp;withuserscaling=&#34;true&#34;&nbsp;&gt;<br>&lt;t:paintarea&nbsp;id=&#34;g_14&#34;&nbsp;actionListener=&#34;#{d.DemoPaintAreaSelection.onPaintAreaInvoke}&#34;&nbsp;background=&#34;#FFFFFF&#34;&nbsp;editgrid=&#34;10&#34;&nbsp;editgridsnapto=&#34;true&#34;&nbsp;height=&#34;100%&#34;&nbsp;rangeselectionrequireskey=&#34;true&#34;&nbsp;width=&#34;100%&#34;&nbsp;withrangeselection=&#34;true&#34;&nbsp;&gt;<br>&lt;t:dynamiccontent&nbsp;id=&#34;g_16&#34;&nbsp;contentbinding=&#34;#{d.DemoPaintAreaSelection.content}&#34;&nbsp;/&gt;<br>&lt;/t:paintarea&gt;<br>&lt;/t:scalepane&gt;<br>&lt;/t:row&gt;<br>&lt;/t:scrollpane&gt;<br>&lt;/t:row&gt;<br>&lt;/t:rowdemobodypane&gt;<br>&lt;t:pageaddons&nbsp;id=&#34;g_pa&#34;/&gt;<br>&lt;/t:layoutdefinition&gt;</p>
<p>This is the Java code:</p>
<p class="java">package&nbsp;workplace;<br><br>import&nbsp;java.io.Serializable;<br>import&nbsp;java.util.ArrayList;<br>import&nbsp;java.util.List;<br><br>import&nbsp;javax.faces.event.ActionEvent;<br><br>import&nbsp;org.eclnt.editor.annotations.CCGenClass;<br>import&nbsp;org.eclnt.jsfserver.defaultscreens.Statusbar;<br>import&nbsp;org.eclnt.jsfserver.elements.componentnodes.LABELNode;<br>import&nbsp;org.eclnt.jsfserver.elements.componentnodes.PAINTAREAITEMNode;<br>import&nbsp;org.eclnt.jsfserver.elements.events.BaseActionEventRangeSelection;<br>import&nbsp;org.eclnt.jsfserver.elements.impl.DYNAMICCONTENTBinding;<br>import&nbsp;org.eclnt.jsfserver.elements.impl.ROWDYNAMICCONTENTBinding;<br>import&nbsp;org.eclnt.jsfserver.elements.impl.ROWDYNAMICCONTENTBinding.ComponentNode;<br>import&nbsp;org.eclnt.workplace.IWorkpageDispatcher;<br><br>@CCGenClass&nbsp;(expressionBase=&#34;#{d.DemoPaintAreaSelection}&#34;)<br><br>public&nbsp;class&nbsp;DemoPaintAreaSelection<br>&nbsp;&nbsp;&nbsp;&nbsp;extends&nbsp;WorkpageDispatchedPageBean&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;implements&nbsp;Serializable<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;inner&nbsp;classes<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;class&nbsp;ItemInfo<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;i_bounds;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;i_selected;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getBounds()&nbsp;{&nbsp;return&nbsp;i_bounds;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setBounds(String&nbsp;bounds)&nbsp;{&nbsp;i_bounds&nbsp;=&nbsp;bounds;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;isSelected()&nbsp;{&nbsp;return&nbsp;i_selected;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setSelected(boolean&nbsp;selected)&nbsp;{&nbsp;i_selected&nbsp;=&nbsp;selected;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getText()&nbsp;{&nbsp;return&nbsp;i_bounds&nbsp;+&nbsp;&#34;/&#34;&nbsp;+&nbsp;i_selected;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;members<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br><br>&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;m_scale&nbsp;=&nbsp;1f;<br>&nbsp;&nbsp;&nbsp;&nbsp;DYNAMICCONTENTBinding&nbsp;m_content&nbsp;=&nbsp;new&nbsp;DYNAMICCONTENTBinding();<br>&nbsp;&nbsp;&nbsp;&nbsp;List&lt;ItemInfo&gt;&nbsp;m_itemInfos&nbsp;=&nbsp;new&nbsp;ArrayList&lt;DemoPaintAreaSelection.ItemInfo&gt;();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;constructors&nbsp;&amp;&nbsp;initialization<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;DemoPaintAreaSelection(IWorkpageDispatcher&nbsp;workpageDispatcher)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(workpageDispatcher);&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createItems();<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getPageName()&nbsp;{&nbsp;return&nbsp;&#34;/workplace/demopaintareaselection.jsp&#34;;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getRootExpressionUsedInPage()&nbsp;{&nbsp;return&nbsp;&#34;#{d.DemoPaintAreaSelection}&#34;;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;public&nbsp;usage<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;DYNAMICCONTENTBinding&nbsp;getContent()&nbsp;{&nbsp;return&nbsp;m_content;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;List&lt;ItemInfo&gt;&nbsp;getItemInfos()&nbsp;{&nbsp;return&nbsp;m_itemInfos;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;getScalePercent()&nbsp;{&nbsp;return&nbsp;Math.round(m_scale*100f);&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setScalePercent(int&nbsp;value)&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_scale&nbsp;=&nbsp;(float)value/100f;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;float&nbsp;getScale()&nbsp;{&nbsp;return&nbsp;m_scale;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setScale(float&nbsp;value)&nbsp;{&nbsp;this.m_scale&nbsp;=&nbsp;value;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;onPaintAreaInvoke(ActionEvent&nbsp;event)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(event&nbsp;instanceof&nbsp;BaseActionEventRangeSelection)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseActionEventRangeSelection&nbsp;e&nbsp;=&nbsp;(BaseActionEventRangeSelection)event;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Statusbar.outputSuccess(&#34;Range&nbsp;selection:&nbsp;&#34;&nbsp;+&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.getLeft()&nbsp;+&nbsp;&#34;,&nbsp;&#34;&nbsp;+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.getTop()&nbsp;+&nbsp;&#34;,&nbsp;&#34;&nbsp;+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.getWidth()&nbsp;+&nbsp;&#34;,&nbsp;&#34;&nbsp;+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.getHeight());<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;private&nbsp;usage<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;createItems()<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&lt;ComponentNode&gt;&nbsp;l&nbsp;=&nbsp;new&nbsp;ArrayList&lt;ROWDYNAMICCONTENTBinding.ComponentNode&gt;();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i=0;&nbsp;i&lt;10;&nbsp;i++)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;j=0;&nbsp;j&lt;10;&nbsp;j++)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;iiIndex&nbsp;=&nbsp;m_itemInfos.size();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ItemInfo&nbsp;ii&nbsp;=&nbsp;new&nbsp;ItemInfo();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.setBounds((50+i*150)+&#34;;&#34;+(50+j*50)&nbsp;+&#34;;130;40;10&#34;);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_itemInfos.add(ii);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAINTAREAITEMNode&nbsp;pain&nbsp;=&nbsp;new&nbsp;PAINTAREAITEMNode()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setBounds(pbx(&#34;itemInfos[&#34;+iiIndex+&#34;].bounds&#34;))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setSelected(pbx(&#34;itemInfos[&#34;+iiIndex+&#34;].selected&#34;))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setBackground(&#34;#e0e0e0&#34;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setMovingenabled(&#34;true&#34;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setResizingenabled(&#34;true&#34;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setFlush(true)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setBorder(&#34;#00000030&#34;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setSelectionenabled(true);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l.add(pain);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LABELNode&nbsp;la&nbsp;=&nbsp;new&nbsp;LABELNode()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setText(pbx(&#34;itemInfos[&#34;+iiIndex+&#34;].text&#34;))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setAlign(&#34;center&#34;);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pain.addSubNode(la);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_content.setContentNodes(l);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></p>
</body>
</html>
