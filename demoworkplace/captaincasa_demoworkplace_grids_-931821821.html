<html>
<head>
<style>
.java {font-family: monospace;background-color: #F0F0F0;}
.xml {font-family: monospace;background-color: #F0F0F0;}
</style>
</head>
<body>
<p>The context of this demo is the creation of a dialog using the CaptainCasa framework for the following purpose: <ul><li>Grids &amp; Trees</li><li>Grids and Trees</li><li>Load on Demand (1)</li></ul></p>
<p>Nothing special with this grid - from visual point of view...! But have look onto the way the grid is filled on server side:<br><br>The grid is loaded with 1000 items. The items themselves are not read when filling the grid in the constructor, but the items are read step by step, following the user&#39;s navigation within the grid.<br><br>In the constructor of the server side bean 1000 &#34;null items&#34; are filled into the grid. Every time the user scrolls through the grid then the method &#34;getRows()&#34; is called on server side. This method returns the visual part of the grid that is sent to the client. The grid&#39;s &#34;sbvalue&#34; property tells you about the current scroll position of the user.<br><br>By overriding the method you can check if all items that the user wants to see are available. When missing items are detected they are picked from the logic.<br><br>Pay attention: the user may scroll through the list of items in &#34;wild ways&#34;. You must not expect the user to scroll step by step from the top to the bottom of the list, so that you can fill the item list in an ordered way. You must expect the user to &#34;randomly access&#34; the grid&#39;s items.<br><br>By the way: getSbvalue() gives you the current scroll position, getSbvisibleamount() gives you the number of grid items that are displayed on client side as maximum and getClientvisibleamount() gives you the number of actually rendered items within the client.</p>
<p>This is the XML layout definition:</p>
<p class="xml">&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;?&gt;<br>&lt;t:layoutdefinition&nbsp;xmlns:t=&#34;http://www.CaptainCasa.com/controllibrary/t&#34;&nbsp;xmlns:tpbc=&#34;http://www.CaptainCasa.com/controllibrary/tpbc&#34;&nbsp;&gt;<br>&lt;t:rowdemobodypane&nbsp;id=&#34;g_1&#34;&nbsp;objectbinding=&#34;#{d.demoGridloadondemand}&#34;&nbsp;rowdistance=&#34;#{ccstylevalue[&#39;@defaultrowdistance@&#39;]}&#34;&nbsp;&gt;<br>&lt;t:row&nbsp;id=&#34;g_2&#34;&nbsp;&gt;<br>&lt;t:fixgrid&nbsp;id=&#34;g_3&#34;&nbsp;avoidroundtrips=&#34;true&#34;&nbsp;bordercolor=&#34;#{ccstylevalue.ccLightBorderColor}&#34;&nbsp;borderheight=&#34;1&#34;&nbsp;borderwidth=&#34;1&#34;&nbsp;height=&#34;100%&#34;&nbsp;objectbinding=&#34;#{d.demoGridloadondemand.grid}&#34;&nbsp;sbvisibleamount=&#34;25&#34;&nbsp;width=&#34;100%&#34;&nbsp;&gt;<br>&lt;t:gridcol&nbsp;id=&#34;g_4&#34;&nbsp;text=&#34;First&nbsp;Name&#34;&nbsp;width=&#34;50%&#34;&nbsp;&gt;<br>&lt;t:field&nbsp;id=&#34;g_5&#34;&nbsp;text=&#34;.{firstName}&#34;&nbsp;/&gt;<br>&lt;/t:gridcol&gt;<br>&lt;t:gridcol&nbsp;id=&#34;g_6&#34;&nbsp;text=&#34;Last&nbsp;Name&#34;&nbsp;width=&#34;50%&#34;&nbsp;&gt;<br>&lt;t:field&nbsp;id=&#34;g_7&#34;&nbsp;text=&#34;.{lastName}&#34;&nbsp;/&gt;<br>&lt;/t:gridcol&gt;<br>&lt;/t:fixgrid&gt;<br>&lt;/t:row&gt;<br>&lt;t:row&nbsp;id=&#34;g_8&#34;&nbsp;coldistance=&#34;5&#34;&nbsp;&gt;<br>&lt;t:coldistance&nbsp;id=&#34;g_9&#34;&nbsp;width=&#34;100%&#34;&nbsp;/&gt;<br>&lt;t:button&nbsp;id=&#34;g_10&#34;&nbsp;actionListener=&#34;#{d.DemoGridloadondemand.onScrollToTop}&#34;&nbsp;text=&#34;Scroll&nbsp;to&nbsp;Top&#34;&nbsp;/&gt;<br>&lt;t:button&nbsp;id=&#34;g_11&#34;&nbsp;actionListener=&#34;#{d.DemoGridloadondemand.onScrollToEnd}&#34;&nbsp;text=&#34;Scroll&nbsp;to&nbsp;Bottom&#34;&nbsp;/&gt;<br>&lt;/t:row&gt;<br>&lt;/t:rowdemobodypane&gt;<br>&lt;t:pageaddons&nbsp;id=&#34;g_pa&#34;/&gt;<br>&lt;/t:layoutdefinition&gt;</p>
<p>This is the Java code:</p>
<p class="java">package&nbsp;workplace;<br><br>import&nbsp;java.util.List;<br><br>import&nbsp;javax.faces.event.ActionEvent;<br><br>import&nbsp;org.eclnt.jsfserver.elements.impl.FIXGRIDItem;<br>import&nbsp;org.eclnt.jsfserver.elements.impl.FIXGRIDListBinding;<br>import&nbsp;org.eclnt.jsfserver.elements.util.FIXGRIDPivotListBinding;<br>import&nbsp;org.eclnt.workplace.IWorkpageDispatcher;<br><br>public&nbsp;class&nbsp;DemoGridloadondemand&nbsp;extends&nbsp;PageBean<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;inner&nbsp;classes<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;class&nbsp;MyRow&nbsp;extends&nbsp;FIXGRIDItem<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;m_firstName;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;m_lastName;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setLastName(String&nbsp;value)&nbsp;{&nbsp;m_lastName&nbsp;=&nbsp;value;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getLastName()&nbsp;{&nbsp;return&nbsp;m_lastName;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setFirstName(String&nbsp;value)&nbsp;{&nbsp;m_firstName&nbsp;=&nbsp;value;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getFirstName()&nbsp;{&nbsp;return&nbsp;m_firstName;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;class&nbsp;MyGrid&nbsp;extends&nbsp;FIXGRIDListBinding&lt;MyRow&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;***&nbsp;Old,&nbsp;still&nbsp;valid&nbsp;way&nbsp;of&nbsp;load&nbsp;on&nbsp;demand&nbsp;-&nbsp;overriding&nbsp;the&nbsp;getRows()&nbsp;method&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;***&nbsp;Disadvantage:&nbsp;in&nbsp;getRows()&nbsp;you&nbsp;must&nbsp;not&nbsp;change&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;item&nbsp;list&nbsp;(getItems()).<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;List&lt;MyRow&gt;&nbsp;getRows()<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&lt;MyRow&gt;&nbsp;result&nbsp;=&nbsp;super.getRows();<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;check&nbsp;if&nbsp;all&nbsp;items&nbsp;are&nbsp;read<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;foundNullItem&nbsp;=&nbsp;false;<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i=0;&nbsp;i&lt;result.size();&nbsp;i++)<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(result.get(i)&nbsp;==&nbsp;null)<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foundNullItem&nbsp;=&nbsp;true;<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readItem(getSbvalue()+i);<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(foundNullItem&nbsp;==&nbsp;false)<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result;<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;super.getRows();<br>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;***&nbsp;&#34;New&#34;&nbsp;way&nbsp;of&nbsp;load&nbsp;on&nbsp;demand:&nbsp;executing&nbsp;load&nbsp;on&nbsp;demand&nbsp;when&nbsp;grid&nbsp;rendering&nbsp;starts.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;renderingBegins()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super.renderingBegins();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&lt;MyRow&gt;&nbsp;result&nbsp;=&nbsp;super.getRows();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;check&nbsp;if&nbsp;all&nbsp;items&nbsp;that&nbsp;are&nbsp;transferred&nbsp;to&nbsp;the&nbsp;client&nbsp;are&nbsp;read<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i=0;&nbsp;i&lt;result.size();&nbsp;i++)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(result.get(i)&nbsp;==&nbsp;null)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readItem(getSbvalue()+i);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;members<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;MyGrid&nbsp;m_grid&nbsp;=&nbsp;new&nbsp;MyGrid();<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;constructors<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;DemoGridloadondemand(IWorkpageDispatcher&nbsp;dispatcher)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(dispatcher);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initializeGridWithNullItems();<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;public&nbsp;usage<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;FIXGRIDListBinding&lt;MyRow&gt;&nbsp;getGrid()&nbsp;{&nbsp;return&nbsp;m_grid;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;onScrollToTop(ActionEvent&nbsp;event)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;newSbValue&nbsp;=&nbsp;0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_grid.setSbvalue(newSbValue);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;onScrollToEnd(ActionEvent&nbsp;event)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;newSbValue&nbsp;=&nbsp;m_grid.getItems().size()&nbsp;-&nbsp;m_grid.getClientvisibleamount();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_grid.setSbvalue(newSbValue);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;private&nbsp;usage<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;------------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;initializeGridWithNullItems()<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i=0;&nbsp;i&lt;1000;&nbsp;i++)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_grid.getItems().add(null);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;readItem(int&nbsp;index)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MyRow&nbsp;row&nbsp;=&nbsp;new&nbsp;MyRow();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.m_firstName&nbsp;=&nbsp;&#34;First&nbsp;Name&nbsp;&#34;&nbsp;+&nbsp;index;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.m_lastName&nbsp;=&nbsp;&#34;Last&nbsp;Name&nbsp;&#34;&nbsp;+&nbsp;index;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_grid.getItems().set(index,row);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>}<br></p>
</body>
</html>
