<html>
<head>
<style>
.java {font-family: monospace;background-color: #F0F0F0;}
.xml {font-family: monospace;background-color: #F0F0F0;}
</style>
</head>
<body>
<p>The context of this demo is the creation of a dialog using the CaptainCasa framework for the following purpose: <ul><li>General</li><li>Client Integration</li><li>Client Local Storage</li></ul></p>
<p>The component CLIENTLOCALSTORAGE stores and reads a string value within the client side storage.<br><br>The client side storage is a name/value based storage - so you have to define the NAME attribute with the key you want to use to store data on client side. <br><br>The VALUE attribute is used in two directions: if you change the value on server side, then the new value is written into the storage on client side. And: if the component is started then the current content of the client storage is written into the VALUE.<br><br>Please note: there is a certain complexity involved in order to get the current client storage value to the server side at startup point of time of the dialog: <br>The component transfers the value with the next roundtrip from the client to the server side. So you have to trigger this roundtrip explicitly. The component to use is the component CALLSERVERONTRIGGER which executes one roundtrip when being triggered.<br><br>And please note: there is a component CLIENTCOOKIE doing exactly the same - but storing the value on client side as cookie.</p>
<p>This is the XML layout definition:</p>
<p class="xml">&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;?&gt;<br>&lt;t:layoutdefinition&nbsp;xmlns:t=&#34;http://www.CaptainCasa.com/controllibrary/t&#34;&nbsp;xmlns:tpbc=&#34;http://www.CaptainCasa.com/controllibrary/tpbc&#34;&nbsp;&gt;<br>&lt;t:beanprocessing&nbsp;id=&#34;g_1&#34;&nbsp;&gt;<br>&lt;t:callserverontrigger&nbsp;id=&#34;g_2&#34;&nbsp;actionListener=&#34;#{d.DemoClientLocalStorage.onRoundtripAction}&#34;&nbsp;trigger=&#34;#{d.DemoClientLocalStorage.roundtripTrigger}&#34;&nbsp;/&gt;<br>&lt;t:clientlocalstorage&nbsp;id=&#34;g_3&#34;&nbsp;name=&#34;test&#34;&nbsp;value=&#34;#{d.DemoClientLocalStorage.localStorageContent}&#34;&nbsp;/&gt;<br>&lt;/t:beanprocessing&gt;<br>&lt;t:rowdemobodypane&nbsp;id=&#34;g_4&#34;&nbsp;objectbinding=&#34;#{d.DemoClientLocalStorage}&#34;&nbsp;rowdistance=&#34;#{ccstylevalue[&#39;@defaultrowdistance@&#39;]}&#34;&nbsp;&gt;<br>&lt;t:row&nbsp;id=&#34;g_5&#34;&nbsp;&gt;<br>&lt;t:label&nbsp;id=&#34;g_6&#34;&nbsp;text=&#34;Client&nbsp;local&nbsp;storage&nbsp;value&#34;&nbsp;width=&#34;200&#34;&nbsp;/&gt;<br>&lt;t:label&nbsp;id=&#34;g_7&#34;&nbsp;text=&#34;#{d.DemoClientLocalStorage.localStorageContent}&#34;&nbsp;/&gt;<br>&lt;/t:row&gt;<br>&lt;t:rowdistance&nbsp;id=&#34;g_8&#34;&nbsp;height=&#34;60&#34;&nbsp;/&gt;<br>&lt;t:row&nbsp;id=&#34;g_9&#34;&nbsp;&gt;<br>&lt;t:label&nbsp;id=&#34;g_10&#34;&nbsp;text=&#34;New&nbsp;Content&#34;&nbsp;width=&#34;200&#34;&nbsp;/&gt;<br>&lt;t:field&nbsp;id=&#34;g_11&#34;&nbsp;text=&#34;#{d.DemoClientLocalStorage.newContent}&#34;&nbsp;width=&#34;100%&#34;&nbsp;/&gt;<br>&lt;/t:row&gt;<br>&lt;t:row&nbsp;id=&#34;g_12&#34;&nbsp;&gt;<br>&lt;t:coldistance&nbsp;id=&#34;g_13&#34;&nbsp;width=&#34;200&#34;&nbsp;/&gt;<br>&lt;t:button&nbsp;id=&#34;g_14&#34;&nbsp;actionListener=&#34;#{d.DemoClientLocalStorage.onSetContent}&#34;&nbsp;text=&#34;Set&nbsp;Content&#34;&nbsp;/&gt;<br>&lt;/t:row&gt;<br>&lt;/t:rowdemobodypane&gt;<br>&lt;t:pageaddons&nbsp;id=&#34;g_pa&#34;/&gt;<br>&lt;/t:layoutdefinition&gt;</p>
<p>This is the Java code:</p>
<p class="java">package&nbsp;workplace;<br><br>import&nbsp;java.io.Serializable;<br><br>import&nbsp;javax.faces.event.ActionEvent;<br><br>import&nbsp;org.eclnt.editor.annotations.CCGenClass;<br>import&nbsp;org.eclnt.jsfserver.elements.util.Trigger;<br>import&nbsp;org.eclnt.workplace.IWorkpageDispatcher;<br><br>@CCGenClass&nbsp;(expressionBase=&#34;#{d.DemoClientLocalStorage}&#34;)<br><br>public&nbsp;class&nbsp;DemoClientLocalStorage<br>&nbsp;&nbsp;&nbsp;&nbsp;extends&nbsp;PageBean&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;implements&nbsp;Serializable<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;Trigger&nbsp;m_roundtripTrigger&nbsp;=&nbsp;new&nbsp;Trigger();<br>&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;m_newContent;<br>&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;m_localStorageContent;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;DemoClientLocalStorage(IWorkpageDispatcher&nbsp;workpageDispatcher)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(workpageDispatcher);&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;initiate&nbsp;one&nbsp;roundtrip&nbsp;through&nbsp;component&nbsp;CALLSERVERONTRIGGER<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;so&nbsp;that&nbsp;cookie&nbsp;value&nbsp;is&nbsp;immediately&nbsp;transferred&nbsp;at&nbsp;startup<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_roundtripTrigger.trigger();<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Trigger&nbsp;getRoundtripTrigger()&nbsp;{&nbsp;return&nbsp;m_roundtripTrigger;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getLocalStorageContent()&nbsp;{&nbsp;return&nbsp;m_localStorageContent;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setLocalStorageContent(String&nbsp;value)&nbsp;{&nbsp;m_localStorageContent&nbsp;=&nbsp;value;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getNewContent()&nbsp;{&nbsp;return&nbsp;m_newContent;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setNewContent(String&nbsp;value)&nbsp;{&nbsp;this.m_newContent&nbsp;=&nbsp;value;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;onRoundtripAction(ActionEvent&nbsp;event)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;no&nbsp;action&nbsp;required&nbsp;-&nbsp;the&nbsp;roundtrip&#39;s&nbsp;purpose&nbsp;is&nbsp;to&nbsp;let&nbsp;the&nbsp;CLIENTCOOKIE<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;control&nbsp;pass&nbsp;the&nbsp;value.<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;onSetContent(ActionEvent&nbsp;event)&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_localStorageContent&nbsp;=&nbsp;m_newContent;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_newContent&nbsp;=&nbsp;null;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>}<br></p>
</body>
</html>
