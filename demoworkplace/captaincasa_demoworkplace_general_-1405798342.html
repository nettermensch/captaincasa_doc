<html>
<head>
<style>
.java {font-family: monospace;background-color: #F0F0F0;}
.xml {font-family: monospace;background-color: #F0F0F0;}
</style>
</head>
<body>
<p>The context of this demo is the creation of a dialog using the CaptainCasa framework for the following purpose: <ul><li>General</li><li>Client Integration</li><li>Client File API (Java Client only)</li><li>File Poller</li></ul></p>
<p>The file poller is an invisible component that allows to establish a client side file interface for sending data to the server.<br><br>A certain directory (FILEDIRECTORY) is regularly scanned (SCANDURATION) for new files - either for all files of for files holding a certain extension (FILEEXTENSIONS).<br><br>When a new file is detected the component first renames it to, then calls the action listener and passes the name of the file and its content to the server side processing. In the server side action event you gain access to the data.<br><br>Please be aware of that there may be several files that are transferred via one action event! You need to scan through the whole list of strings that is provided by BaseActionEventClientFilePoll.getFileNamesAndContent in order to catch all files that were polled.<br><br>After the files are uploaded from client side, the files by default are removed. For monitoring reasons you may specify attribute POSTTRANSFERBEHAVIOR as &#34;keep&#34; - the renamed files will be kept in the same directory. </p>
<p>This is the XML layout definition:</p>
<p class="xml">&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;?&gt;<br>&lt;t:layoutdefinition&nbsp;xmlns:t=&#34;http://www.CaptainCasa.com/controllibrary/t&#34;&nbsp;xmlns:tpbc=&#34;http://www.CaptainCasa.com/controllibrary/tpbc&#34;&nbsp;&gt;<br>&lt;t:beanprocessing&nbsp;id=&#34;g_1&#34;&nbsp;&gt;<br>&lt;t:clientfilepoller&nbsp;id=&#34;g_2&#34;&nbsp;actionListener=&#34;#{d.DemoFilePoller.onPollAction}&#34;&nbsp;filedirectory=&#34;c:&#92;temp&#92;filepoller&#34;&nbsp;posttransferbehavior=&#34;remove&#34;&nbsp;scanduration=&#34;1000&#34;&nbsp;/&gt;<br>&lt;/t:beanprocessing&gt;<br>&lt;t:rowdemobodypane&nbsp;id=&#34;g_3&#34;&nbsp;objectbinding=&#34;#{d.DemoFilePoller}&#34;&nbsp;rowdistance=&#34;#{ccstylevalue[&#39;@defaultrowdistance@&#39;]}&#34;&nbsp;&gt;<br>&lt;t:row&nbsp;id=&#34;g_4&#34;&nbsp;&gt;<br>&lt;t:label&nbsp;id=&#34;g_5&#34;&nbsp;text=&#34;Copy&nbsp;some&nbsp;files&nbsp;into&nbsp;the&nbsp;directory&nbsp;c:&#92;temp&#92;demofilepoller&nbsp;...&#34;&nbsp;/&gt;<br>&lt;/t:row&gt;<br>&lt;t:row&nbsp;id=&#34;g_6&#34;&nbsp;&gt;<br>&lt;t:textarea&nbsp;id=&#34;g_7&#34;&nbsp;height=&#34;200&#34;&nbsp;text=&#34;#{d.DemoFilePoller.pollInfo}&#34;&nbsp;width=&#34;100%&#34;&nbsp;/&gt;<br>&lt;/t:row&gt;<br>&lt;/t:rowdemobodypane&gt;<br>&lt;t:pageaddons&nbsp;id=&#34;g_pa&#34;/&gt;<br>&lt;/t:layoutdefinition&gt;</p>
<p>This is the Java code:</p>
<p class="java">package&nbsp;workplace;<br><br>import&nbsp;java.io.Serializable;<br>import&nbsp;org.eclnt.editor.annotations.CCGenClass;<br>import&nbsp;org.eclnt.jsfserver.elements.events.BaseActionEventClientFilePoll;<br>import&nbsp;org.eclnt.workplace.IWorkpageDispatcher;<br>import&nbsp;org.eclnt.workplace.WorkpageDispatchedBean;<br><br>import&nbsp;javax.faces.event.ActionEvent;<br><br>@CCGenClass&nbsp;(expressionBase=&#34;#{d.DemoFilePoller}&#34;)<br><br>public&nbsp;class&nbsp;DemoFilePoller<br>&nbsp;&nbsp;&nbsp;&nbsp;extends&nbsp;PageBean&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;implements&nbsp;Serializable<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;m_pollInfo;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;DemoFilePoller(IWorkpageDispatcher&nbsp;workpageDispatcher)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(workpageDispatcher);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_pollInfo&nbsp;=&nbsp;&#34;&lt;no&nbsp;poll&nbsp;action&nbsp;yet&gt;&#34;;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getPollInfo()&nbsp;{&nbsp;return&nbsp;m_pollInfo;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setPollInfo(String&nbsp;value)&nbsp;{&nbsp;this.m_pollInfo&nbsp;=&nbsp;value;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;onPollAction(ActionEvent&nbsp;event)&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(event&nbsp;instanceof&nbsp;BaseActionEventClientFilePoll)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StringBuffer&nbsp;sb&nbsp;=&nbsp;new&nbsp;StringBuffer();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseActionEventClientFilePoll&nbsp;e&nbsp;=&nbsp;(BaseActionEventClientFilePoll)event;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String[]&nbsp;infos&nbsp;=&nbsp;e.getFileNamesAndContent();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i=0;&nbsp;i&lt;infos.length;&nbsp;i+=2)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(&#34;&#92;nFile&nbsp;name:&nbsp;&#34;&nbsp;+&nbsp;infos[i]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(&#34;&#92;nFile&nbsp;content&nbsp;length:&nbsp;&#34;&nbsp;+&nbsp;infos[i+1].length()/2);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(&#34;&#92;n&#92;n&#34;);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_pollInfo&nbsp;=&nbsp;sb.toString();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>}<br></p>
</body>
</html>
